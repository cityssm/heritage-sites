"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{let e=[];const t=document.querySelector("#heritageSiteModal"),a=()=>{t.classList.remove("is-active"),document.querySelector("html").classList.remove("is-clipped")},s=()=>{const s=window.location.hash.slice(1).toLowerCase();a();const r=e.find(e=>e.siteId.toLowerCase()===s);r&&(""!==r.pageName&&(t.querySelector("[data-field='page']").innerHTML='<p class="pt-4 has-text-centered"><i class="fas fa-3x fa-spin fa-circle-notch has-text-grey-lighter"></i><br /><em class="has-text-grey">Loading details...</em></p>',window.fetch("pages/"+r.pageName+".htm").then(e=>e.text()).then(e=>(t.querySelector("[data-field='page']").innerHTML=e,!0)).catch(()=>{t.querySelector("[data-field='page']").innerHTML=""})),t.querySelector("[data-field='civicAddress']").textContent=r.civicAddress,t.classList.add("is-active"),document.querySelector("html").classList.add("is-clipped"))},r=document.querySelector("#searchString"),i=document.querySelector("#searchResults"),o=()=>{let t=0;const a=document.createElement("div");a.className="panel";const s=r.value,o=s.toLowerCase().split(" "),n=new URL(window.location);""===s?n.search="":n.searchParams.set("searchString",s),window.history.pushState({},"",n);for(const s of e){let e=!0;for(const t of o)if(!s.searchString.includes(t)){e=!1;break}if(e){t+=1;const e=document.createElement("a");e.className="panel-block is-block",e.href="#"+s.siteId,e.innerHTML='<div class="columns"><div class="column is-7"><strong data-field="descriptionOfProperty"></strong><br /><span data-field="civicAddress" title="Civic Address"></span></div><div class="column is-5"><span data-field="bylawNumber" title="Bylaw Number"></span><br /><span data-field="datePassed" title="Date Passed"></span></div>',e.querySelector("[data-field='descriptionOfProperty']").textContent=s.descriptionOfProperty,e.querySelector("[data-field='civicAddress']").textContent=s.civicAddress,e.querySelector("[data-field='bylawNumber']").textContent=s.bylawNumber,e.querySelector("[data-field='datePassed']").textContent=s.datePassed,a.append(e)}}i.innerHTML="",t>0&&i.append(a)};if(""!==window.location.search){const e=new URL(window.location.href).searchParams.get("searchString");e&&(r.value=e)}window.fetch("data/heritageSites.json").then(e=>e.json()).then(t=>{e=t;for(const t of e)t.searchString=t.descriptionOfProperty.toLowerCase()+" "+t.civicAddress.toLowerCase()+" "+t.keywords.toLowerCase();return""!==window.location.hash&&s(),o()}).catch(()=>{bulmaJS.alert({title:"Error Loading Heritage Sites",message:"Please refresh this page to try again.",contextualColorName:"danger",okButton:{text:"Refresh Now",callbackFunction:()=>{window.location.reload()}}})}),r.addEventListener("keyup",o),t.querySelector(".modal-close").addEventListener("click",()=>{a(),window.location.hash=""}),window.addEventListener("hashchange",s)})();